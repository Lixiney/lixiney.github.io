<!DOCTYPE html><html lang="zh" data-theme="light"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0,viewport-fit=cover"><title>CTF-MISC杂项 | Lixiney's Blog</title><meta name="author" content="Lixiney"><meta name="copyright" content="Lixiney"><meta name="format-detection" content="telephone=no"><meta name="theme-color" content="#ffffff"><meta name="description" content="MISC 杂项文件的操作文件类型识别 file 命令	使用场景：不知道文件名，无法打开文件 winhex          使用场景：windows下通过文件头信息判断文件类型  常见文件头、文件尾    文件格式 文件头 文件尾    JPEG (jpg)文件头 FFD8FF FF D9   PNG (png)文件头 89504E47 AE 42 60 82   GIF (gif) 文件头 47">
<meta property="og:type" content="article">
<meta property="og:title" content="CTF-MISC杂项">
<meta property="og:url" content="http://blog.lixey.top/2024/09/02/CTF-MISC%E6%9D%82%E9%A1%B9/index.html">
<meta property="og:site_name" content="Lixiney&#39;s Blog">
<meta property="og:description" content="MISC 杂项文件的操作文件类型识别 file 命令	使用场景：不知道文件名，无法打开文件 winhex          使用场景：windows下通过文件头信息判断文件类型  常见文件头、文件尾    文件格式 文件头 文件尾    JPEG (jpg)文件头 FFD8FF FF D9   PNG (png)文件头 89504E47 AE 42 60 82   GIF (gif) 文件头 47">
<meta property="og:locale">
<meta property="og:image" content="http://blog.lixey.top/img/3.jpg">
<meta property="article:published_time" content="2024-09-02T13:20:14.000Z">
<meta property="article:modified_time" content="2024-09-03T10:52:30.000Z">
<meta property="article:author" content="Lixiney">
<meta property="article:tag" content="MISC">
<meta property="article:tag" content="CTF">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="http://blog.lixey.top/img/3.jpg"><link rel="shortcut icon" href="/img/favicon.png"><link rel="canonical" href="http://blog.lixey.top/2024/09/02/CTF-MISC%E6%9D%82%E9%A1%B9/index.html"><link rel="preconnect" href="//cdn.jsdelivr.net"/><link rel="preconnect" href="//busuanzi.ibruce.info"/><link rel="stylesheet" href="/css/index.css?v=4.13.0"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@6.5.1/css/all.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fancyapps/ui@5.0.33/dist/fancybox/fancybox.min.css" media="print" onload="this.media='all'"><script>const GLOBAL_CONFIG = {
  root: '/',
  algolia: undefined,
  localSearch: undefined,
  translate: undefined,
  noticeOutdate: undefined,
  highlight: {"plugin":"highlight.js","highlightCopy":true,"highlightLang":true,"highlightHeightLimit":false},
  copy: {
    success: 'Copy Successful',
    error: 'Copy Error',
    noSupport: 'Browser Not Supported'
  },
  relativeDate: {
    homepage: false,
    post: false
  },
  runtime: '',
  dateSuffix: {
    just: 'Just now',
    min: 'minutes ago',
    hour: 'hours ago',
    day: 'days ago',
    month: 'months ago'
  },
  copyright: undefined,
  lightbox: 'fancybox',
  Snackbar: undefined,
  infinitegrid: {
    js: 'https://cdn.jsdelivr.net/npm/@egjs/infinitegrid@4.11.1/dist/infinitegrid.min.js',
    buttonText: 'Load More'
  },
  isPhotoFigcaption: false,
  islazyload: false,
  isAnchor: false,
  percent: {
    toc: true,
    rightside: false,
  },
  autoDarkmode: false
}</script><script id="config-diff">var GLOBAL_CONFIG_SITE = {
  title: 'CTF-MISC杂项',
  isPost: true,
  isHome: false,
  isHighlightShrink: false,
  isToc: true,
  postUpdate: '2024-09-03 18:52:30'
}</script><script>(win=>{
      win.saveToLocal = {
        set: (key, value, ttl) => {
          if (ttl === 0) return
          const now = Date.now()
          const expiry = now + ttl * 86400000
          const item = {
            value,
            expiry
          }
          localStorage.setItem(key, JSON.stringify(item))
        },
      
        get: key => {
          const itemStr = localStorage.getItem(key)
      
          if (!itemStr) {
            return undefined
          }
          const item = JSON.parse(itemStr)
          const now = Date.now()
      
          if (now > item.expiry) {
            localStorage.removeItem(key)
            return undefined
          }
          return item.value
        }
      }
    
      win.getScript = (url, attr = {}) => new Promise((resolve, reject) => {
        const script = document.createElement('script')
        script.src = url
        script.async = true
        script.onerror = reject
        script.onload = script.onreadystatechange = function() {
          const loadState = this.readyState
          if (loadState && loadState !== 'loaded' && loadState !== 'complete') return
          script.onload = script.onreadystatechange = null
          resolve()
        }

        Object.keys(attr).forEach(key => {
          script.setAttribute(key, attr[key])
        })

        document.head.appendChild(script)
      })
    
      win.getCSS = (url, id = false) => new Promise((resolve, reject) => {
        const link = document.createElement('link')
        link.rel = 'stylesheet'
        link.href = url
        if (id) link.id = id
        link.onerror = reject
        link.onload = link.onreadystatechange = function() {
          const loadState = this.readyState
          if (loadState && loadState !== 'loaded' && loadState !== 'complete') return
          link.onload = link.onreadystatechange = null
          resolve()
        }
        document.head.appendChild(link)
      })
    
      win.activateDarkMode = () => {
        document.documentElement.setAttribute('data-theme', 'dark')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#0d0d0d')
        }
      }
      win.activateLightMode = () => {
        document.documentElement.setAttribute('data-theme', 'light')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#ffffff')
        }
      }
      const t = saveToLocal.get('theme')
    
        if (t === 'dark') activateDarkMode()
        else if (t === 'light') activateLightMode()
      
      const asideStatus = saveToLocal.get('aside-status')
      if (asideStatus !== undefined) {
        if (asideStatus === 'hide') {
          document.documentElement.classList.add('hide-aside')
        } else {
          document.documentElement.classList.remove('hide-aside')
        }
      }
    
      const detectApple = () => {
        if(/iPad|iPhone|iPod|Macintosh/.test(navigator.userAgent)){
          document.documentElement.classList.add('apple')
        }
      }
      detectApple()
    })(window)</script><link rel="stylesheet" href="//at.alicdn.com/t/c/font_4066449_d5kq6u6u9dj.css"><link rel="stylesheet" href="/css/mine.css"><meta name="generator" content="Hexo 7.3.0"></head><body><div id="web_bg"></div><div id="sidebar"><div id="menu-mask"></div><div id="sidebar-menus"><div class="avatar-img is-center"><img src="/img/avator.jpg" onerror="onerror=null;src='/img/friend_404.gif'" alt="avatar"/></div><div class="sidebar-site-data site-data is-center"><a href="/archives/"><div class="headline">Articles</div><div class="length-num">31</div></a><a href="/tags/"><div class="headline">Tags</div><div class="length-num">22</div></a><a href="/categories/"><div class="headline">Categories</div><div class="length-num">2</div></a></div><hr class="custom-hr"/><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw iconfont icon-zhuye"></i><span> 首页</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw iconfont icon-archive-solid"></i><span> 归档</span></a></div><div class="menus_item"><a class="site-page group" href="javascript:void(0);"><i class="fa-fw iconfont icon-bagua2"></i><span> 修仙日记</span><i class="fas fa-chevron-down"></i></a><ul class="menus_item_child"><li><a class="site-page child" href="/categories/%E7%8E%84%E9%97%A8%E4%BA%94%E6%9C%AF"><i class="fa-fw iconfont icon-shen"></i><span> 玄门五术</span></a></li><li><a class="site-page child" href="/categories/%E9%81%93%E5%AE%B6%E7%BB%8F%E5%85%B8"><i class="fa-fw iconfont icon-ti"></i><span> 道家经典</span></a></li></ul></div></div></div></div><div class="post" id="body-wrap"><header class="post-bg" id="page-header" style="background-image: url('/img/3.jpg')"><nav id="nav"><span id="blog-info"><a href="/" title="Lixiney's Blog"><span class="site-name">Lixiney's Blog</span></a></span><div id="menus"><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw iconfont icon-zhuye"></i><span> 首页</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw iconfont icon-archive-solid"></i><span> 归档</span></a></div><div class="menus_item"><a class="site-page group" href="javascript:void(0);"><i class="fa-fw iconfont icon-bagua2"></i><span> 修仙日记</span><i class="fas fa-chevron-down"></i></a><ul class="menus_item_child"><li><a class="site-page child" href="/categories/%E7%8E%84%E9%97%A8%E4%BA%94%E6%9C%AF"><i class="fa-fw iconfont icon-shen"></i><span> 玄门五术</span></a></li><li><a class="site-page child" href="/categories/%E9%81%93%E5%AE%B6%E7%BB%8F%E5%85%B8"><i class="fa-fw iconfont icon-ti"></i><span> 道家经典</span></a></li></ul></div></div><div id="toggle-menu"><a class="site-page" href="javascript:void(0);"><i class="fas fa-bars fa-fw"></i></a></div></div></nav><div id="post-info"><h1 class="post-title">CTF-MISC杂项</h1><div id="post-meta"><div class="meta-firstline"><span class="post-meta-date"><i class="far fa-calendar-alt fa-fw post-meta-icon"></i><span class="post-meta-label">Created</span><time class="post-meta-date-created" datetime="2024-09-02T13:20:14.000Z" title="Created 2024-09-02 21:20:14">2024-09-02</time><span class="post-meta-separator">|</span><i class="fas fa-history fa-fw post-meta-icon"></i><span class="post-meta-label">Updated</span><time class="post-meta-date-updated" datetime="2024-09-03T10:52:30.000Z" title="Updated 2024-09-03 18:52:30">2024-09-03</time></span></div><div class="meta-secondline"><span class="post-meta-separator">|</span><span class="post-meta-pv-cv" id="" data-flag-title="CTF-MISC杂项"><i class="far fa-eye fa-fw post-meta-icon"></i><span class="post-meta-label">Post Views:</span><span id="busuanzi_value_page_pv"><i class="fa-solid fa-spinner fa-spin"></i></span></span></div></div></div></header><main class="layout" id="content-inner"><div id="post"><article class="post-content" id="article-container"><h1 id="MISC-杂项"><a href="#MISC-杂项" class="headerlink" title="MISC 杂项"></a>MISC 杂项</h1><h2 id="文件的操作"><a href="#文件的操作" class="headerlink" title="文件的操作"></a>文件的操作</h2><h3 id="文件类型识别"><a href="#文件类型识别" class="headerlink" title="文件类型识别"></a>文件类型识别</h3><ol>
<li>file 命令	使用场景：不知道文件名，无法打开文件</li>
<li>winhex          使用场景：windows下通过文件头信息判断文件类型</li>
</ol>
<p>常见文件头、文件尾</p>
<table>
<thead>
<tr>
<th>文件格式</th>
<th>文件头</th>
<th>文件尾</th>
</tr>
</thead>
<tbody><tr>
<td>JPEG (jpg)文件头</td>
<td>FFD8FF</td>
<td>FF D9</td>
</tr>
<tr>
<td>PNG (png)文件头</td>
<td>89504E47</td>
<td>AE 42 60 82</td>
</tr>
<tr>
<td>GIF (gif) 文件头</td>
<td>47494638</td>
<td>00 3B</td>
</tr>
<tr>
<td>TIFF (tif)文件头</td>
<td>49492A00</td>
<td></td>
</tr>
<tr>
<td>XML (xml)文件头</td>
<td>3C3F786D6C</td>
<td></td>
</tr>
<tr>
<td>HTML (html)文件头</td>
<td>68746D6C3E</td>
<td></td>
</tr>
<tr>
<td>Adobe Acrobat (pdf)文件头</td>
<td>255044462D312E</td>
<td></td>
</tr>
<tr>
<td>ZIP Archive (zip)文件头</td>
<td>504B0304</td>
<td>504B</td>
</tr>
<tr>
<td>TAR （tar.gz）文件头</td>
<td>1F8B0800</td>
<td></td>
</tr>
<tr>
<td>RAR Archive (rar)文件头</td>
<td>526172211A0700 C43D7B00400700</td>
<td>C43D7B00400700</td>
</tr>
<tr>
<td>Wave (wav)文件头</td>
<td>57415645</td>
<td></td>
</tr>
<tr>
<td>AVI (avi)，文件头</td>
<td>41564920</td>
<td></td>
</tr>
<tr>
<td>MS Word&#x2F;Excel (xls.or.doc)文件头</td>
<td>D0CF11E0</td>
<td></td>
</tr>
<tr>
<td>Adobe Photoshop (psd)文件头</td>
<td>38425053</td>
<td></td>
</tr>
<tr>
<td>Windows Bitmap (bmp) 文件头</td>
<td>424D</td>
<td></td>
</tr>
</tbody></table>
<h3 id="文件分离"><a href="#文件分离" class="headerlink" title="文件分离"></a>文件分离</h3><ol>
<li>binwalk  工具</li>
</ol>
<p>用法：</p>
<ul>
<li>分析文件</li>
</ul>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">sudo</span> binwalk filename</span><br></pre></td></tr></table></figure>

<ul>
<li>分离文件</li>
</ul>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">sudo</span> binwalk -e filename</span><br></pre></td></tr></table></figure>

<ol>
<li>foremost 工具</li>
</ol>
<p>如果 binwalk 无法正确 分离出文件，可以使用该工具</p>
<p>用法：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">sudo</span> foremost 文件名 -o 输出文件夹</span><br></pre></td></tr></table></figure>

<ol>
<li>dd</li>
</ol>
<p>当文件自动分离出错或者因为其他原因无法自动分离时，可以使用 dd 实现文件手动分离</p>
<p>用法：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">sudo</span> <span class="built_in">dd</span> <span class="keyword">if</span>=源文件 of=目标文件名 bs=1 skip=开始分离的字节数</span><br></pre></td></tr></table></figure>

<p>参数说明：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">if=file 	#输入文件名，缺省为标准输入</span><br><span class="line">of=file 	#输出文件名，缺省为标准输入</span><br><span class="line">bs=bytes	#同时设置读写块的大小为bytes，可代替ibs和obs</span><br><span class="line">skip=blocks	#从输入文件开头跳过blocks个块后再开始复制</span><br></pre></td></tr></table></figure>

<p><strong>方法二：可以尝试修改后缀名，但当隐藏了多种格式时可能会失败</strong></p>
<h3 id="文件合并"><a href="#文件合并" class="headerlink" title="文件合并"></a>文件合并</h3><ol>
<li>Linux 下的文件合并</li>
</ol>
<p>使用场景：linux 下，通常对文件名相似的文件要进行批量合并</p>
<p>格式：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">cat</span> 文件名1 文件名2 文件名3 &gt; 输出的文件</span><br></pre></td></tr></table></figure>

<p>完整性检测：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">md5sum</span> 文件名</span><br></pre></td></tr></table></figure>

<ol start="2">
<li>windows 下的文件合并</li>
</ol>
<p>使用场景：windows 下，通常要对文件名相似的文件进行批量合并</p>
<p>格式：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">copy /B 合并的文件 输出的文件命令</span><br></pre></td></tr></table></figure>

<p>完整性检测：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">certutil -hashfile 文件名 md5 </span><br></pre></td></tr></table></figure>

<h2 id="图片隐写"><a href="#图片隐写" class="headerlink" title="图片隐写"></a>图片隐写</h2><h3 id="补充："><a href="#补充：" class="headerlink" title="补充："></a>补充：</h3><p>​	首先使用 16进制编辑器 查看文件 或者使用 binwalk  有时 flag 会直接写在 里面</p>
<h3 id="LSB-隐写"><a href="#LSB-隐写" class="headerlink" title="LSB 隐写"></a>LSB 隐写</h3><ol>
<li>zsteg 工具</li>
</ol>
<p>使用：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">zsteg xxxx.jpg</span><br></pre></td></tr></table></figure>

<ol start="2">
<li>wbstego4 工具</li>
</ol>
<p>解密通过 lsb 加密的图片，bmp格式</p>
<p><img src="/2024/09/02/CTF-MISC%E6%9D%82%E9%A1%B9/1.png"></p>
<ol start="3">
<li>stegsolve</li>
</ol>
<p><img src="/2024/09/02/CTF-MISC%E6%9D%82%E9%A1%B9/aaaaa.png"></p>
<h3 id="文件CRC校验出错"><a href="#文件CRC校验出错" class="headerlink" title="文件CRC校验出错"></a>文件CRC校验出错</h3><p>图片 CRC 计算</p>
<p>TweakPNG</p>
<p><img src="/2024/09/02/CTF-MISC%E6%9D%82%E9%A1%B9/2.png"></p>
<p><img src="/2024/09/02/CTF-MISC%E6%9D%82%E9%A1%B9/32.png"></p>
<p>python -&gt; 计算文件宽高 </p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> zlib</span><br><span class="line"><span class="keyword">import</span> struct</span><br><span class="line"><span class="keyword">import</span> argparse</span><br><span class="line"><span class="keyword">import</span> itertools</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">parser = argparse.ArgumentParser()</span><br><span class="line">parser.add_argument(<span class="string">&quot;-f&quot;</span>, <span class="built_in">type</span>=<span class="built_in">str</span>, default=<span class="literal">None</span>, required=<span class="literal">True</span>,</span><br><span class="line">                 <span class="built_in">help</span>=<span class="string">&quot;输入同级目录下图片的名称&quot;</span>)</span><br><span class="line">args  = parser.parse_args()</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">bin_data = <span class="built_in">open</span>(args.f, <span class="string">&#x27;rb&#x27;</span>).read()</span><br><span class="line">crc32key = zlib.crc32(bin_data[<span class="number">12</span>:<span class="number">29</span>]) <span class="comment"># 计算crc</span></span><br><span class="line">original_crc32 = <span class="built_in">int</span>(bin_data[<span class="number">29</span>:<span class="number">33</span>].<span class="built_in">hex</span>(), <span class="number">16</span>) <span class="comment"># 原始crc</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> crc32key == original_crc32: <span class="comment"># 计算crc对比原始crc</span></span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&#x27;宽高没有问题!&#x27;</span>)</span><br><span class="line"><span class="keyword">else</span>:</span><br><span class="line">    input_ = <span class="built_in">input</span>(<span class="string">&quot;宽高被改了, 是否CRC爆破宽高? (Y/n):&quot;</span>)</span><br><span class="line">    <span class="keyword">if</span> input_ <span class="keyword">not</span> <span class="keyword">in</span> [<span class="string">&quot;Y&quot;</span>, <span class="string">&quot;y&quot;</span>, <span class="string">&quot;&quot;</span>]:</span><br><span class="line">        exit()</span><br><span class="line">    <span class="keyword">else</span>: </span><br><span class="line">        <span class="keyword">for</span> i, j <span class="keyword">in</span> itertools.product(<span class="built_in">range</span>(<span class="number">4095</span>), <span class="built_in">range</span>(<span class="number">4095</span>)): <span class="comment"># 理论上0x FF FF FF FF，但考虑到屏幕实际/cpu，0x 0F FF就差不多了，也就是4095宽度和高度</span></span><br><span class="line">            data = bin_data[<span class="number">12</span>:<span class="number">16</span>] + struct.pack(<span class="string">&#x27;&gt;i&#x27;</span>, i) + struct.pack(<span class="string">&#x27;&gt;i&#x27;</span>, j) + bin_data[<span class="number">24</span>:<span class="number">29</span>]</span><br><span class="line">            crc32 = zlib.crc32(data)</span><br><span class="line">            <span class="keyword">if</span>(crc32 == original_crc32): <span class="comment"># 计算当图片大小为i:j时的CRC校验值，与图片中的CRC比较，当相同，则图片大小已经确定</span></span><br><span class="line">                <span class="built_in">print</span>(<span class="string">f&quot;\nCRC32: <span class="subst">&#123;<span class="built_in">hex</span>(original_crc32)&#125;</span>&quot;</span>)</span><br><span class="line">                <span class="built_in">print</span>(<span class="string">f&quot;宽度: <span class="subst">&#123;i&#125;</span>, hex: <span class="subst">&#123;<span class="built_in">hex</span>(i)&#125;</span>&quot;</span>)</span><br><span class="line">                <span class="built_in">print</span>(<span class="string">f&quot;高度: <span class="subst">&#123;j&#125;</span>, hex: <span class="subst">&#123;<span class="built_in">hex</span>(j)&#125;</span>&quot;</span>)</span><br><span class="line">                exit(<span class="number">0</span>)</span><br></pre></td></tr></table></figure>

<p>使用方法：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">python 文件名.py -f 图片</span><br></pre></td></tr></table></figure>

<h3 id="Exif隐写"><a href="#Exif隐写" class="headerlink" title="Exif隐写"></a>Exif隐写</h3><p>Exiftools</p>
<p><img src="/2024/09/02/CTF-MISC%E6%9D%82%E9%A1%B9/14.png"></p>
<h3 id="GIF-隐写"><a href="#GIF-隐写" class="headerlink" title="GIF 隐写"></a>GIF 隐写</h3><p>stegsole -&gt;  需要 java 环境</p>
<p><img src="/2024/09/02/CTF-MISC%E6%9D%82%E9%A1%B9/31.png"></p>
<p>逐帧查看</p>
<h3 id="bftools-工具"><a href="#bftools-工具" class="headerlink" title="bftools 工具"></a>bftools 工具</h3><p>使用场景：在 windows 的 cmd 下，对加密过的图片文件进行解密</p>
<p><img src="/2024/09/02/CTF-MISC%E6%9D%82%E9%A1%B9/15.png"></p>
<p>格式：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">bftools decode braincopter 要解密的图片名称 -out 输出文件名</span><br></pre></td></tr></table></figure>

<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">bftools run 上一步输出的文件名称</span><br></pre></td></tr></table></figure>

<h3 id="silenteye-工具"><a href="#silenteye-工具" class="headerlink" title="silenteye 工具"></a>silenteye 工具</h3><p><img src="/2024/09/02/CTF-MISC%E6%9D%82%E9%A1%B9/16.png"></p>
<p>对音频或者图片解密</p>
<h3 id="Stegdetect-工具探测加密方式"><a href="#Stegdetect-工具探测加密方式" class="headerlink" title="Stegdetect 工具探测加密方式"></a>Stegdetect 工具探测加密方式</h3><p>根据探测到的加密方式，选择对应的工具破解</p>
<p>常见加密 : steg, Jphide, outguess, invisible secretc, f5 appendx 和 camouflage</p>
<p><img src="/2024/09/02/CTF-MISC%E6%9D%82%E9%A1%B9/18.png"></p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">stegdetect 文件名</span><br></pre></td></tr></table></figure>

<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">stegdetect -s 敏感度 文件名</span><br></pre></td></tr></table></figure>

<h3 id="outguess-工具"><a href="#outguess-工具" class="headerlink" title="outguess 工具"></a>outguess 工具</h3><p>当 stegdetect 提示 outguess 加密时 </p>
<p><img src="/2024/09/02/CTF-MISC%E6%9D%82%E9%A1%B9/17.png"></p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">outguess 要解密的文件名 输出结果文件名</span><br></pre></td></tr></table></figure>

<h3 id="JPhs-工具"><a href="#JPhs-工具" class="headerlink" title="JPhs 工具"></a>JPhs 工具</h3><p><img src="/2024/09/02/CTF-MISC%E6%9D%82%E9%A1%B9/19.png"></p>
<h3 id="F5"><a href="#F5" class="headerlink" title="F5"></a>F5</h3><p>使用场景，当 stegdetect 识别出来是F5 加密的图片</p>
<p>使用方法 ： 进入F5 -steganography_F5 目录 ,将 图片 拷贝 到给目录下</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">java extact 要解密的文件名 -p 密码</span><br></pre></td></tr></table></figure>

<h3 id="CQR-二维码处理"><a href="#CQR-二维码处理" class="headerlink" title="CQR 二维码处理"></a>CQR 二维码处理</h3><p><img src="/2024/09/02/CTF-MISC%E6%9D%82%E9%A1%B9/20.png"></p>
<h2 id="压缩文件处理"><a href="#压缩文件处理" class="headerlink" title="压缩文件处理"></a>压缩文件处理</h2><h3 id="伪加密"><a href="#伪加密" class="headerlink" title="伪加密"></a>伪加密</h3><p>如果压缩文件是加密的，或者文件头正常但是压缩错误，首先尝试问就按是否是伪加密。zip文件是否是加密，是通过标识符来显示的，在每个文件的文件目录字段有一位专门标识了文件是否加密，将其实设置为00表示该文件未加密，如果成功解压则文件为伪加密，如果解压出错说明文件为真加密，这时候就需要根据线索，或者使用工具来破解密码.</p>
<p><strong>如果是真加密也不用担心，密码一般都不会太复杂，而且一般都会给出密码位数（在爆破工具中要选择位数），它主要考察有没有暴力破解的工具和技术</strong></p>
<h4 id="zip-伪加密"><a href="#zip-伪加密" class="headerlink" title="zip 伪加密"></a>zip 伪加密</h4><p><img src="/2024/09/02/CTF-MISC%E6%9D%82%E9%A1%B9/25.png"></p>
<p>用 WinHex 或者 010editor 打开 文件 将 标识的两处 09 00 改成 00 00  保存文件</p>
<p><img src="/2024/09/02/CTF-MISC%E6%9D%82%E9%A1%B9/22.png"></p>
<p><img src="/2024/09/02/CTF-MISC%E6%9D%82%E9%A1%B9/23.png"></p>
<p><strong>注：如果修改错误或者是真加密，文件名后面会有 星号 （  *  ）或者打开错误</strong></p>
<h4 id="rar-伪加密"><a href="#rar-伪加密" class="headerlink" title="rar 伪加密"></a>rar 伪加密</h4><p>rar 文件由于有头部校验， 使用 伪加密时 打开文件会出现报错，使用winhex 修改标志位后如果报错消失且正常解压缩，说明是伪加密。使用winhex 打开rar 文件，找到第24个字节，该字节尾数为4 表示加密，0表示无加密，将尾数改为0即可破解伪加密</p>
<p><img src="/2024/09/02/CTF-MISC%E6%9D%82%E9%A1%B9/26.png"></p>
<h3 id="zip-密码破解"><a href="#zip-密码破解" class="headerlink" title="zip 密码破解"></a>zip 密码破解</h3><p>ziperello 工具</p>
<p><img src="/2024/09/02/CTF-MISC%E6%9D%82%E9%A1%B9/27.png"></p>
<h3 id="rar-密码破解"><a href="#rar-密码破解" class="headerlink" title="rar 密码破解"></a>rar 密码破解</h3><p>ARCHPR 工具</p>
<p><img src="/2024/09/02/CTF-MISC%E6%9D%82%E9%A1%B9/28.png"></p>
<p>如果知道密码的一部分可以选择使用掩码</p>
<h5 id="明文攻击"><a href="#明文攻击" class="headerlink" title="明文攻击"></a>明文攻击</h5><p>使用场景：已知加密的压缩文件中的铭文内容</p>
<p>例： 假设一个加密的压缩包中有两个文件 readme.txt 和 flag.txt，其中 flag.txt 的内容是我们希望知道的内容，而我们拥有readme.txt 的明文文件，使用上述两个文件可进行明文攻击</p>
<p>操作:</p>
<ol>
<li>将readme.txt 文件进行压缩，编程readme1.rar</li>
<li>打开 ARCHAR ，攻击类型选择明文，明文文件路径选择readme1.rar（j将明文文件不加密压缩后的文件），加密的文件</li>
<li>选择要破解的文件，点击开始，破解成功</li>
</ol>
<p><strong>注意： 使用该方法需要注意两个关键点</strong></p>
<ul>
<li>有一个明文文件，压缩后CRC值与加密压缩包中的文件一致</li>
<li>明文文件的压缩算法需要与加密压缩文件的压缩算法一致</li>
</ul>
<p><strong>有时候不一定能破解出文件口令，但是能够找到加密密钥等信息，可以直接将文件解密，点解确定保存解密后的文件即可</strong></p>
<p><img src="/2024/09/02/CTF-MISC%E6%9D%82%E9%A1%B9/30.png"></p>
<h2 id="流量分析-wireshark"><a href="#流量分析-wireshark" class="headerlink" title="流量分析 wireshark"></a>流量分析 wireshark</h2><p>流量分析中常用协议</p>
<ul>
<li>TCP</li>
<li>UDP</li>
<li>HTTP</li>
<li>TLS</li>
<li>HTTPS</li>
<li>USB</li>
<li>DNS</li>
<li>WIFI</li>
<li>ICMP</li>
<li>ARP</li>
</ul>
<p><img src="/2024/09/02/CTF-MISC%E6%9D%82%E9%A1%B9/3.png"></p>
<h3 id="流量包修复"><a href="#流量包修复" class="headerlink" title="流量包修复"></a>流量包修复</h3><h4 id="tshark"><a href="#tshark" class="headerlink" title="tshark"></a>tshark</h4><p>wireshark 的命令行版</p>
<p><img src="/2024/09/02/CTF-MISC%E6%9D%82%E9%A1%B9/4.png"></p>
<h3 id="协议分析"><a href="#协议分析" class="headerlink" title="协议分析"></a>协议分析</h3><h3 id="数据提取"><a href="#数据提取" class="headerlink" title="数据提取"></a>数据提取</h3><h4 id="方法1："><a href="#方法1：" class="headerlink" title="方法1："></a>方法1：</h4><h5 id="过滤ip"><a href="#过滤ip" class="headerlink" title="过滤ip"></a>过滤ip</h5><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ip.src eq x.x.x.x or ip.dst eq x.x.x.x 或 ip.addr eq x.x.x.x</span><br></pre></td></tr></table></figure>

<h5 id="过滤端口"><a href="#过滤端口" class="headerlink" title="过滤端口"></a>过滤端口</h5><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">tcp.port eq 80 or udp.port eq 80</span><br><span class="line">tcp.dstport == 80 只显示tcp协议的目标端口为80 </span><br><span class="line">tcp.srcport == 80 只显示tcp协议的源端口为80</span><br><span class="line">tcp.port &gt;= 1 and tcp.port &lt;= 80</span><br></pre></td></tr></table></figure>

<h5 id="过滤协议"><a href="#过滤协议" class="headerlink" title="过滤协议"></a>过滤协议</h5><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">tcp/udp/arp/icmp/http/ftp/dns/ip</span><br></pre></td></tr></table></figure>

<h5 id="过滤mac"><a href="#过滤mac" class="headerlink" title="过滤mac"></a>过滤mac</h5><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">eth.dst == A0:00:00:04:C:84   过滤目标mac地址</span><br></pre></td></tr></table></figure>

<h5 id="包长度过滤"><a href="#包长度过滤" class="headerlink" title="包长度过滤"></a>包长度过滤</h5><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">udp.length == 26</span><br></pre></td></tr></table></figure>

<h5 id="USB流量分析"><a href="#USB流量分析" class="headerlink" title="USB流量分析"></a>USB流量分析</h5><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">tshark -r usb1.pcap -T fields -e usb.capdata &gt; usbdata.txt</span><br></pre></td></tr></table></figure>



<h4 id="方法2："><a href="#方法2：" class="headerlink" title="方法2："></a>方法2：</h4><ul>
<li>使用 Github 上一个大佬写的工具\<ul>
<li><a target="_blank" rel="noopener" href="https://github.com/Mumuzi7179/UsbKeyboard_Mouse_Hacker_Gui">https://github.com/Mumuzi7179/UsbKeyboard_Mouse_Hacker_Gui</a></li>
<li><img src="/2024/09/02/CTF-MISC%E6%9D%82%E9%A1%B9/Mouse_Key2.png"></li>
</ul>
</li>
</ul>
<ul>
<li>选择要提取的数据，选择键盘或者鼠标流量，将cap文件拖入程序中即可</li>
</ul>
</article><div class="post-copyright"><div class="post-copyright__author"><span class="post-copyright-meta"><i class="fas fa-circle-user fa-fw"></i>Author: </span><span class="post-copyright-info"><a href="http://blog.lixey.top">Lixiney</a></span></div><div class="post-copyright__type"><span class="post-copyright-meta"><i class="fas fa-square-arrow-up-right fa-fw"></i>Link: </span><span class="post-copyright-info"><a href="http://blog.lixey.top/2024/09/02/CTF-MISC%E6%9D%82%E9%A1%B9/">http://blog.lixey.top/2024/09/02/CTF-MISC%E6%9D%82%E9%A1%B9/</a></span></div><div class="post-copyright__notice"><span class="post-copyright-meta"><i class="fas fa-circle-exclamation fa-fw"></i>Copyright Notice: </span><span class="post-copyright-info">All articles in this blog are licensed under <a target="_blank" rel="noopener" href="https://creativecommons.org/licenses/by-nc-sa/4.0/">CC BY-NC-SA 4.0</a> unless stating additionally.</span></div></div><div class="tag_share"><div class="post_share"><div class="social-share" data-image="/img/3.jpg" data-sites="facebook,twitter,wechat,weibo,qq"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/butterfly-extsrc@1.1.3/sharejs/dist/css/share.min.css" media="print" onload="this.media='all'"><script src="https://cdn.jsdelivr.net/npm/butterfly-extsrc@1.1.3/sharejs/dist/js/social-share.min.js" defer></script></div></div><nav class="pagination-post" id="pagination"><div class="prev-post pull-left"><a href="/2024/09/02/%E5%90%8E%E7%AB%AF%E5%BC%80%E5%8F%91-Python%E3%80%8CFlask%E6%A1%86%E6%9E%B6%E3%80%8D/" title="后端开发-Python「Flask框架」"><img class="cover" src="/img/20.png" onerror="onerror=null;src='/img/404.jpg'" alt="cover of previous post"><div class="pagination-info"><div class="label">Previous</div><div class="prev_info">后端开发-Python「Flask框架」</div></div></a></div><div class="next-post pull-right"><a href="/2024/09/02/Web%E5%AE%89%E5%85%A8-%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E/" title="Web安全-文件上传漏洞"><img class="cover" src="/img/9.jpg" onerror="onerror=null;src='/img/404.jpg'" alt="cover of next post"><div class="pagination-info"><div class="label">Next</div><div class="next_info">Web安全-文件上传漏洞</div></div></a></div></nav><div class="relatedPosts"><div class="headline"><i class="fas fa-thumbs-up fa-fw"></i><span>Related Articles</span></div><div class="relatedPosts-list"><div><a href="/2024/09/28/CTF%E5%B8%B8%E7%94%A8%E5%B7%A5%E5%85%B7/" title="CTF常用工具"><img class="cover" src="/img/12.png" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2024-09-28</div><div class="title">CTF常用工具</div></div></a></div><div><a href="/2024/09/23/PHP%E4%BB%A3%E7%A0%81%E5%AE%A1%E8%AE%A1-%E5%BA%8F%E5%88%97%E5%8C%96%E4%B8%8E%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96/" title="PHP代码审计-序列化与反序列化"><img class="cover" src="/img/1.jpg" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2024-09-23</div><div class="title">PHP代码审计-序列化与反序列化</div></div></a></div></div></div></div><div class="aside-content" id="aside-content"><div class="card-widget card-info"><div class="is-center"><div class="avatar-img"><img src="/img/avator.jpg" onerror="this.onerror=null;this.src='/img/friend_404.gif'" alt="avatar"/></div><div class="author-info__name">Lixiney</div><div class="author-info__description"></div></div><div class="card-info-data site-data is-center"><a href="/archives/"><div class="headline">Articles</div><div class="length-num">31</div></a><a href="/tags/"><div class="headline">Tags</div><div class="length-num">22</div></a><a href="/categories/"><div class="headline">Categories</div><div class="length-num">2</div></a></div><a id="card-info-btn" target="_blank" rel="noopener" href="https://github.com/Lixiney"><i class="fab fa-github"></i><span>Follow Me</span></a></div><div class="card-widget card-announcement"><div class="item-headline"><i class="fas fa-bullhorn fa-shake"></i><span>Announcement</span></div><div class="announcement_content">This is my Blog</div></div><div class="sticky_layout"><div class="card-widget" id="card-toc"><div class="item-headline"><i class="fas fa-stream"></i><span>Contents</span><span class="toc-percentage"></span></div><div class="toc-content"><ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#MISC-%E6%9D%82%E9%A1%B9"><span class="toc-number">1.</span> <span class="toc-text">MISC 杂项</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%96%87%E4%BB%B6%E7%9A%84%E6%93%8D%E4%BD%9C"><span class="toc-number">1.1.</span> <span class="toc-text">文件的操作</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%96%87%E4%BB%B6%E7%B1%BB%E5%9E%8B%E8%AF%86%E5%88%AB"><span class="toc-number">1.1.1.</span> <span class="toc-text">文件类型识别</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%96%87%E4%BB%B6%E5%88%86%E7%A6%BB"><span class="toc-number">1.1.2.</span> <span class="toc-text">文件分离</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%96%87%E4%BB%B6%E5%90%88%E5%B9%B6"><span class="toc-number">1.1.3.</span> <span class="toc-text">文件合并</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%9B%BE%E7%89%87%E9%9A%90%E5%86%99"><span class="toc-number">1.2.</span> <span class="toc-text">图片隐写</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%A1%A5%E5%85%85%EF%BC%9A"><span class="toc-number">1.2.1.</span> <span class="toc-text">补充：</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#LSB-%E9%9A%90%E5%86%99"><span class="toc-number">1.2.2.</span> <span class="toc-text">LSB 隐写</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%96%87%E4%BB%B6CRC%E6%A0%A1%E9%AA%8C%E5%87%BA%E9%94%99"><span class="toc-number">1.2.3.</span> <span class="toc-text">文件CRC校验出错</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Exif%E9%9A%90%E5%86%99"><span class="toc-number">1.2.4.</span> <span class="toc-text">Exif隐写</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#GIF-%E9%9A%90%E5%86%99"><span class="toc-number">1.2.5.</span> <span class="toc-text">GIF 隐写</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#bftools-%E5%B7%A5%E5%85%B7"><span class="toc-number">1.2.6.</span> <span class="toc-text">bftools 工具</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#silenteye-%E5%B7%A5%E5%85%B7"><span class="toc-number">1.2.7.</span> <span class="toc-text">silenteye 工具</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Stegdetect-%E5%B7%A5%E5%85%B7%E6%8E%A2%E6%B5%8B%E5%8A%A0%E5%AF%86%E6%96%B9%E5%BC%8F"><span class="toc-number">1.2.8.</span> <span class="toc-text">Stegdetect 工具探测加密方式</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#outguess-%E5%B7%A5%E5%85%B7"><span class="toc-number">1.2.9.</span> <span class="toc-text">outguess 工具</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#JPhs-%E5%B7%A5%E5%85%B7"><span class="toc-number">1.2.10.</span> <span class="toc-text">JPhs 工具</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#F5"><span class="toc-number">1.2.11.</span> <span class="toc-text">F5</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#CQR-%E4%BA%8C%E7%BB%B4%E7%A0%81%E5%A4%84%E7%90%86"><span class="toc-number">1.2.12.</span> <span class="toc-text">CQR 二维码处理</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%8E%8B%E7%BC%A9%E6%96%87%E4%BB%B6%E5%A4%84%E7%90%86"><span class="toc-number">1.3.</span> <span class="toc-text">压缩文件处理</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%BC%AA%E5%8A%A0%E5%AF%86"><span class="toc-number">1.3.1.</span> <span class="toc-text">伪加密</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#zip-%E4%BC%AA%E5%8A%A0%E5%AF%86"><span class="toc-number">1.3.1.1.</span> <span class="toc-text">zip 伪加密</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#rar-%E4%BC%AA%E5%8A%A0%E5%AF%86"><span class="toc-number">1.3.1.2.</span> <span class="toc-text">rar 伪加密</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#zip-%E5%AF%86%E7%A0%81%E7%A0%B4%E8%A7%A3"><span class="toc-number">1.3.2.</span> <span class="toc-text">zip 密码破解</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#rar-%E5%AF%86%E7%A0%81%E7%A0%B4%E8%A7%A3"><span class="toc-number">1.3.3.</span> <span class="toc-text">rar 密码破解</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#%E6%98%8E%E6%96%87%E6%94%BB%E5%87%BB"><span class="toc-number">1.3.3.0.1.</span> <span class="toc-text">明文攻击</span></a></li></ol></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%B5%81%E9%87%8F%E5%88%86%E6%9E%90-wireshark"><span class="toc-number">1.4.</span> <span class="toc-text">流量分析 wireshark</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%B5%81%E9%87%8F%E5%8C%85%E4%BF%AE%E5%A4%8D"><span class="toc-number">1.4.1.</span> <span class="toc-text">流量包修复</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#tshark"><span class="toc-number">1.4.1.1.</span> <span class="toc-text">tshark</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%8D%8F%E8%AE%AE%E5%88%86%E6%9E%90"><span class="toc-number">1.4.2.</span> <span class="toc-text">协议分析</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%95%B0%E6%8D%AE%E6%8F%90%E5%8F%96"><span class="toc-number">1.4.3.</span> <span class="toc-text">数据提取</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%96%B9%E6%B3%951%EF%BC%9A"><span class="toc-number">1.4.3.1.</span> <span class="toc-text">方法1：</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#%E8%BF%87%E6%BB%A4ip"><span class="toc-number">1.4.3.1.1.</span> <span class="toc-text">过滤ip</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%E8%BF%87%E6%BB%A4%E7%AB%AF%E5%8F%A3"><span class="toc-number">1.4.3.1.2.</span> <span class="toc-text">过滤端口</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%E8%BF%87%E6%BB%A4%E5%8D%8F%E8%AE%AE"><span class="toc-number">1.4.3.1.3.</span> <span class="toc-text">过滤协议</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%E8%BF%87%E6%BB%A4mac"><span class="toc-number">1.4.3.1.4.</span> <span class="toc-text">过滤mac</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%E5%8C%85%E9%95%BF%E5%BA%A6%E8%BF%87%E6%BB%A4"><span class="toc-number">1.4.3.1.5.</span> <span class="toc-text">包长度过滤</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#USB%E6%B5%81%E9%87%8F%E5%88%86%E6%9E%90"><span class="toc-number">1.4.3.1.6.</span> <span class="toc-text">USB流量分析</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%96%B9%E6%B3%952%EF%BC%9A"><span class="toc-number">1.4.3.2.</span> <span class="toc-text">方法2：</span></a></li></ol></li></ol></li></ol></li></ol></div></div><div class="card-widget card-recent-post"><div class="item-headline"><i class="fas fa-history"></i><span>Recent Post</span></div><div class="aside-list"><div class="aside-list-item"><a class="thumbnail" href="/2024/09/28/CTF%E5%B8%B8%E7%94%A8%E5%B7%A5%E5%85%B7/" title="CTF常用工具"><img src="/img/12.png" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="CTF常用工具"/></a><div class="content"><a class="title" href="/2024/09/28/CTF%E5%B8%B8%E7%94%A8%E5%B7%A5%E5%85%B7/" title="CTF常用工具">CTF常用工具</a><time datetime="2024-09-28T02:20:06.000Z" title="Created 2024-09-28 10:20:06">2024-09-28</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2024/09/23/PHP%E4%BB%A3%E7%A0%81%E5%AE%A1%E8%AE%A1-%E5%BA%8F%E5%88%97%E5%8C%96%E4%B8%8E%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96/" title="PHP代码审计-序列化与反序列化"><img src="/img/1.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="PHP代码审计-序列化与反序列化"/></a><div class="content"><a class="title" href="/2024/09/23/PHP%E4%BB%A3%E7%A0%81%E5%AE%A1%E8%AE%A1-%E5%BA%8F%E5%88%97%E5%8C%96%E4%B8%8E%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96/" title="PHP代码审计-序列化与反序列化">PHP代码审计-序列化与反序列化</a><time datetime="2024-09-23T02:04:22.000Z" title="Created 2024-09-23 10:04:22">2024-09-23</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2024/09/09/%E5%90%8E%E7%AB%AF%E5%BC%80%E5%8F%91-Session%E9%AA%8C%E8%AF%81/" title="后端开发-Session验证"><img src="/img/12.png" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="后端开发-Session验证"/></a><div class="content"><a class="title" href="/2024/09/09/%E5%90%8E%E7%AB%AF%E5%BC%80%E5%8F%91-Session%E9%AA%8C%E8%AF%81/" title="后端开发-Session验证">后端开发-Session验证</a><time datetime="2024-09-09T01:40:36.000Z" title="Created 2024-09-09 09:40:36">2024-09-09</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2024/09/09/%E5%85%A8%E6%A0%88%E5%BC%80%E5%8F%91-Cookie%E9%AA%8C%E8%AF%81/" title="全栈开发-Cookie验证"><img src="/img/12.png" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="全栈开发-Cookie验证"/></a><div class="content"><a class="title" href="/2024/09/09/%E5%85%A8%E6%A0%88%E5%BC%80%E5%8F%91-Cookie%E9%AA%8C%E8%AF%81/" title="全栈开发-Cookie验证">全栈开发-Cookie验证</a><time datetime="2024-09-09T01:40:28.000Z" title="Created 2024-09-09 09:40:28">2024-09-09</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2024/09/09/%E5%89%8D%E5%90%8E%E7%AB%AF%E5%88%86%E7%A6%BB%E5%BC%80%E5%8F%91-JWT%E9%AA%8C%E8%AF%81/" title="前后端分离开发-JWT验证"><img src="/img/28.png" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="前后端分离开发-JWT验证"/></a><div class="content"><a class="title" href="/2024/09/09/%E5%89%8D%E5%90%8E%E7%AB%AF%E5%88%86%E7%A6%BB%E5%BC%80%E5%8F%91-JWT%E9%AA%8C%E8%AF%81/" title="前后端分离开发-JWT验证">前后端分离开发-JWT验证</a><time datetime="2024-09-09T01:33:18.000Z" title="Created 2024-09-09 09:33:18">2024-09-09</time></div></div></div></div></div></div></main><footer id="footer"><div id="footer-wrap"><div class="copyright">&copy;2020 - 2024 By Lixiney</div><div class="framework-info"><span>Framework </span><a target="_blank" rel="noopener" href="https://hexo.io">Hexo</a><span class="footer-separator">|</span><span>Theme </span><a target="_blank" rel="noopener" href="https://github.com/jerryc127/hexo-theme-butterfly">Butterfly</a></div></div></footer></div><div id="rightside"><div id="rightside-config-hide"><button id="readmode" type="button" title="Read Mode"><i class="fas fa-book-open"></i></button><button id="darkmode" type="button" title="Toggle Between Light And Dark Mode"><i class="fas fa-adjust"></i></button><button id="hide-aside-btn" type="button" title="Toggle between Single-column and Double-column"><i class="fas fa-arrows-alt-h"></i></button></div><div id="rightside-config-show"><button id="rightside-config" type="button" title="Setting"><i class="fas fa-cog fa-spin"></i></button><button class="close" id="mobile-toc-button" type="button" title="Table Of Contents"><i class="fas fa-list-ul"></i></button><button id="go-up" type="button" title="Back To Top"><span class="scroll-percent"></span><i class="fas fa-arrow-up"></i></button></div></div><div><script src="/js/utils.js?v=4.13.0"></script><script src="/js/main.js?v=4.13.0"></script><script src="https://cdn.jsdelivr.net/npm/@fancyapps/ui@5.0.33/dist/fancybox/fancybox.umd.min.js"></script><div class="js-pjax"></div><script src="/js/sakuraPlus.js"></script><script async data-pjax src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script></div><script async>window.onload=function(){var a=document.createElement('script'),b=document.getElementsByTagName('script')[0];a.type='text/javascript',a.async=!0,a.src='/sw-register.js?v='+Date.now(),b.parentNode.insertBefore(a,b)};</script></body></html>